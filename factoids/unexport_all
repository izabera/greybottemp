remove all exports in posix sh: eval "$(awk -v q=\' 'function escape (str) { gsub(q, q "\\" q q, str); return str } BEGIN { for (i in ENVIRON) if (i ~ /^[a-zA-Z_][a-zA-Z_0-9]*$/) printf("unset %s; %s=%s\n", i, i, q escape(ENVIRON[i]) q) }')"